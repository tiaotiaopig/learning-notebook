# Shell 变量

> 学习shell编程的初衷就是解放自己，让系统自动化运行命令，而不是自己手动敲
>
> 虽然有一定的学习成本，但是学会以后可以节省很多时间，而且这样晚上回去以后也可以跑实验啦

## Hello World

```bash
# hello.sh
#!/bin/bash 
echo 'hello world!'

# 方法1 
sh hello.sh  

# 方法2 
chmod +x hello.sh 
./hello.sh
```

> `#`是注释内容
>
> `#!/bin/bash`指定shell解释器的路径
>
> 使用方法一运行就不需要指定了，以为已经给定啦
>
> 使用方法二运行，首先需要给文件运行权限，然后`./`这个是必须的，不然shell认为这是一个命令，会到系统路径上去寻找（`/usr/bin`,`/bin`）

## Shell 变量
**定义**
Shell 变量分为**系统变量**和**自定义变量**。系统变量有$HOME、$PWD、$USER等，显示当前 Shell 中所有变量：`set` 。
变量名可以由字母、数字、下划线组成，不能以数字开头。
**基本语法**

- **定义变量：**变量名=变量值，等号两侧不能有空格，变量名一般习惯用大写。
- **删除变量：**unset 变量名 。
- **声明静态变量：**readonly 变量名，静态变量不能unset。
- **使用变量：**$变量名

**将命令返回值赋给变量（重点）**

- A=`ls` 反引号,执行里面的命令
- A=$(ls) 等价于反引号

## Shell 环境变量
**定义**

![img](https://s2.loli.net/2021/12/15/HoF1GRA7Jjgrz29.jpg)
**基本语法**

1. export 变量名=变量值，将 Shell 变量输出为环境变量。
2. source 配置文件路径，让修改后的配置信息立即生效。
3. echo $变量名，检查环境变量是否生效

## 位置参数变量
**基本语法**

- $n ：$0 代表命令本身、$1-$9 代表第1到9个参数，10以上参数用花括号，如 ${10}。
- $* ：命令行中所有参数，且把所有参数看成一个整体。
- $@ ：命令行中所有参数，且把每个参数区分对待。
- $# ：所有参数个数。

**实例：**
编写 Shell 脚本 positionPara.sh ，输出命令行输入的各个参数信息。

```bash
#!/bin/bash     
# 输出各个参数 
echo $0 $1 $2 
echo $* 
echo $@ 
echo 参数个数=$#
```


运行：

```bash
chmod +x positionPara.sh 
./positionPara.sh 10 20
```


运行结果：

```bash
./positionPara.sh 10 20 
10 20 
10 20 
参数个数=2
```

## 预定义变量
**定义**
在赋值定义之前，事先在 Shell 脚本中直接引用的变量。
**基本语法**

- $$ ：当前进程的 PID 进程号。
- $! ：后台运行的最后一个进程的 PID 进程号。
- $? ：最后一次执行的命令的返回状态，0为执行正确，非0执行失败。

**实例：**
编写 Shell 脚本 prePara.sh ，输出命令行输入的各个参数信息。

```powershell
#!/bin/bash     
echo 当前的进程号=$$ 
# &：以后台的方式运行程序 
./hello.sh & 
echo 最后一个进程的进程号=$! 
echo 最后执行的命令结果=$?
运行结果：
```

```bash
当前的进程号=41752 
最后一个进程的进程号=41753 
最后执行的命令结果=0 # hello world!
```