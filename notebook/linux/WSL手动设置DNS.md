# WSL手动设置DNS

>WSL2用着是挺好的，就是发现了一个问题，郁闷了好久，修改`/etc/resolv.conf`可以自己设置dns，但重启WSL以后，手动设置的DNS就会被重置为默认的，细心看了一下默认的文件以后发现了问题的关键。WSL自动在启动时自动根据系统的虚拟交换机`WSL`生成 `/etc/resolv.conf`文件。如下为默认的`/etc/resolv.conf`文件的内容
>
>```shell
># This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:
># [network]
># generateResolvConf = false
>nameserver 172.27.96.1
>```
>
>根据默认文件的描述，首先`sudo vim /etc/wsl.conf`添加`etc/wsl.conf` 文件，文件内容为：
>
>```shell
>[network]
>generateResolvConf = false
>```
>
>保存以后 Powershell 或 Windows Terminal 内`wsl --shutdown` 关机WSL，然后重新打开WSL
>
>手动编辑 `/etc/resolv.conf`文件，手动设置新的DNS即可，例如：
>
>```shell
>nameserver 223.5.5.5
>```
>
>重启试一下，手动设置的DNS已经生效
>
>问题:**Can't open linked file for writing**
>
>解决:删除`/etc/resolv.conf` 这个链接文件,然后`vim /etc/resolv.conf`新建即可 

wsl域名服务器出错解决方案：

网络适配器出错，WSL使用的是WinSocket

管理员打开powershell,运行以下命令

```bash
netsh winsock reset
netsh int ip reset all
netsh winhttp reset proxy
ipconfig /flushdns
```

重启
