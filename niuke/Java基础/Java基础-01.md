# Java基础-01

> [1.多线程](#多线程)
>
> [2.线程安全](#线程安全)

### 多线程

关键点:**进程和线程的关系,多线程的优点**

1. 线程是程序执行的最小单元，一个进程可以拥有多个线程 
2. 各个线程之间共享进程的内存空间（代码段、数据段和堆空间）和系统分配的资源（CPU，I/O，打开的文件），但是各个线程拥有自己的栈空间

多线程优点：

+ 减少程序响应时间,没有前后依赖关系的任务可以并发执行；
+ 提高CPU利用率,使用多线程可以将计算任务分配到多个核心上；
+ 创建和切换开销小,进程创建需要系统分配内存和IO资源等,切换涉及上下文保存和用户态和和心态转化；
+ 数据共享效率高,进程内的多个线程共享线程的内存空间；

### 线程安全

关键点:**原子类,volatile,锁**

1. JDK1.5提供了`java.util.concurrent.atomic`包,原子操作类提供了一种线程安全更新变量的方式,使用**CAS(Compare and Swap)**实现.
2. volatile关键字可以保证多线程访问一个变量时的可见性和有序性.可见性主要是通过:规定写时会将工作内存的值立即刷新到主内存,读时会直接读取主内存的值.有序性通过禁止指令重排序实现.
3. 共享变量是final修饰,是线程安全的
4. synchronized关键字和Lock接口
5. `java.util.concurrent`下的并发工具类, \- Semaphore：就是信号量,可以控制同时访问特定资源的线程数量。 - CountDownLatch：允许一个或多个线程等待其他线程完成操作。 - CyclicBarrier：让一组线程到达一个屏障时被阻塞,直到最后一个线程到达屏障时,屏障才会打开,所有被屏障拦截的线程才会继续运行。
6. 本地存储 我们也可以考虑使用ThreadLocal存储变量,ThreadLocal可以很方便地为每一个线程单独存一份数据,也就是将需要并发访问的资源复制成多份。这样一来,就可以避免多线程访问共享变量了,它们访问的是自己独占的资源,它从根本上隔离了多个线程之间的数据共享