# 基于流关联挖掘的网络安全态势感知

## 安全感知系统架构

1. 流数据采集及存储模块采用 **Snort** 结合 **Flume** 和 **Kafka** 的形式。Snort 部署快速，可扩展性强，兼备流量采集和攻击检测的功能，可以将发送到节点的网络流数据实时地采集到本地磁盘上。Flume 具备高可用，高吞吐量的特点，能够实时监听本地日志以及采集到的流量数据，并与能够实时处理大量数据，满足各种需求场景的消息系统 Kafka 建立 TCP 连接，将数据上传到 Kafka 进行缓存，保证数据的准确性和时效性。 
2. 流浅层特征预告警模块采用 **Flink** 对 Kafka 中存储的数据进行订阅，并结合对各类网络攻击的先验知识进行识别预告警。Flink 相较于 Storm 和 Spark 在时延，吞吐量和容错机制等方面都有着明显的优势，可以实时地对流浅层特征中的源IP 地址，访问端口号，传输协议等信息进行识别和判断，从而帮助网络管理员对网络攻击行为做出快速的应对反应。
3. 流特征关联挖掘算法根据斯皮尔曼系数计算各个特征之间的相关性，生成特征矩阵，并根据设定的阈值，将关联性强的特征筛选出来，结合对特征的理解以及特征的取值范围，去除特征冗余，对特征进行融合并重新编码。为了测试算法的性能，本文使用 UNSW-NB15 数据集和逻辑回归模型进行算法的验证和评估，并PCA（主成分分析）算法进行对比，最终提出一个适用于高速网络流环境下的网络安全态势感知方案，确保在高速网络流环境中感知攻击行为的准确率和实时性，并实现了态势感知原型系统的搭建和部署。 

## 作者认为的网络安全态势感知

> 近年来，一种被普遍认同的说法是，网络安全态势感知是指在网络环境中收集综合、全面的安全要素后，进行数据聚合，最后得到宏观、全面的对网络安全态势的认知。网络安全态势感知是一种整体、动态地发掘网络环境中安全风险的能力，能够有效保障网络安全。网络安全态势感知基于安全大数据，从整体的角度提升对网络安全威胁识别、理解、分析和响应的能力，最终落实系统的安全能力，及时对网络安全威胁做出决策与行动。 

## 主要思路

1. 当短时间内系统接收到的数据量较大时，为了保证系统的实时性，选择流浅层特征预告警模块作为态势评估的主要部分。流浅层特征预告警模块，使用流式计算框架 Flink 对 Kafka中的数据进行识别和处理，结合对已知网络攻击的先验知识，**对网络流中的 IP 地址，端口号，协议等浅层特征的类型及出现频率等进行统计**，从而判断网络节点的安全状况。
2. 攻击手段愈加隐蔽并且不易识别。此外一些网络攻击为了不被识别，故意降低攻击的频率。此时，浅层告警失效，流深层特征关联挖掘模块发挥作用，使用逻辑回归的方法，二分类，识别攻击行为。
3. 主要创新：流特征关联挖掘算法帮助逻辑回归模型在F1 值方面提高了近六个百分点。所提出的特征工程方法，用于数据预处理，提高逻辑回归算法的预测准确率，
4. 实时计算程序提取网络流中的特征，譬如源 IP 地址，目的端口号，协议等，再结合网络攻击行为的先验知识，DDoS 攻击是短时间内相同的 IP 地址频繁请求建立连接却不发送确认数据包，“永恒之蓝”攻击是访问特定的 45 端口，从而初步判断网络环境是否处于安全的状态。

总之就是，统计流量的IP，端口号，协议，结合先验，判断是否安全，对于不易识别的，使用逻辑回归算法进行识别。

## 模型图

![image-20210826131506904](https://i.loli.net/2021/08/26/mCcM6V8uWJXix7t.png)

![image-20210826131638462](https://i.loli.net/2021/08/26/jJO4Fh6qC3WYVi2.png)

